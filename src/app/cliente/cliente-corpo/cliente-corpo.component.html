<!-- páginas do cadastro/confirmação do PF e PJ:
    
    cadastro PJ:
    orcamento/ClienteEdita.asp
    
    consulta PJ:
    idem...
    
    cadastro PF:
    orcamento/ClienteEdita.asp
    
    consulta PF:
    orcamento/clienteedita.asp?cliente_selecionado=000000246890&operacao_selecionada=C

    

    /*
    campos obrigatórios para PF:
    NOME
    CPF
    sexo
    produtor rural
    ENDEREÇO
    nro
    BAIRRO
    CIDADE
    UF
    CEP
    algum telefone

    campos obrigatórios para PJ:
    CNPJ
    CONTRIBUINTE ICMS
    RAZÃO SOCIAL
    TELEFONE
    NOME DA PESSOA PARA CONTATO NA EMPRESA
    ENDEREÇO
    nro
    BAIRRO
    CIDADE
    UF
    CEP

    */


     -->



<!-- 
enquanto está carregando não msotramos NADA!
para não dar erro no console
 -->

<div id="formCadastro" *ngIf="dadosClienteCadastroDto != null">
    <!-- ************   NOME  ************  -->
    <div *ngIf="cadastrando">
        <mat-form-field floatLabel="floatLabel()" *ngIf="ehPf()" class="largura-maxima-campo-formulario">
            <input matInput type="text" placeholder="NOME" [(ngModel)]="dadosClienteCadastroDto.Nome" required
                maxlength="60">
        </mat-form-field>

        <mat-form-field floatLabel="floatLabel()" *ngIf="!ehPf()" class="largura-maxima-campo-formulario">
            <input matInput type="text" placeholder="RAZÃO SOCIAL" [(ngModel)]="dadosClienteCadastroDto.Nome" required
                maxlength="60">
        </mat-form-field>
    </div>

    <div *ngIf="!cadastrando">
        <span class="caixa" *ngIf="ehPf()"><span class="rotulo">Nome:</span> <span
                class="dado">{{dadosClienteCadastroDto?.Nome}}</span></span>
        <span class="caixa" *ngIf="!ehPf()"><span class="rotulo">Razão social:</span> <span
                class="dado">{{dadosClienteCadastroDto?.Nome}}</span></span>
    </div>


    <span *ngIf="cadastrando">
        <!-- CPF e CNPJ não estão ligados ao model pq não são editados -->
        <mat-form-field floatLabel="floatLabel()" *ngIf="!ehPf()" style="width: 22ch;">
            <input matInput type="text" placeholder="CNPJ" readonly="true" [value]="cnpj_cpf_formatado()" required>
        </mat-form-field>

        <mat-form-field floatLabel="floatLabel()" *ngIf="ehPf()" style="width: 22ch;">
            <input matInput type="text" placeholder="CPF" readonly="true" [value]="cnpj_cpf_formatado()" required>
        </mat-form-field>
    </span>
    <span *ngIf="!cadastrando">
        <!-- CPF e CNPJ não estão ligados ao model pq não são editados -->
        <span class="caixa" *ngIf="!ehPf()"><span class="rotulo">CNPJ:</span> <span
                class="dado">{{cnpj_cpf_formatado()}}</span></span>
        <span class="caixa" *ngIf="ehPf()"><span class="rotulo">CPF:</span> <span
                class="dado">{{cnpj_cpf_formatado()}}</span></span>
    </span>

    <!-- ************   CNPJ/IE OU CPF/RG/NASCIMENTO/SEXO  ************  -->
    <!-- campos específicos da pessoa física -->
    <span *ngIf="cadastrando">
        <span *ngIf="ehPf()">
            <mat-form-field floatLabel="floatLabel()" style="width: 22ch;">
                <input matInput type="text" placeholder="RG" [(ngModel)]="dadosClienteCadastroDto.Rg" maxlength="20">
            </mat-form-field>

            <mat-form-field floatLabel="floatLabel()" style="width: 10em;">
                <input matInput type="date" placeholder="NASCIMENTO" [(ngModel)]="dadosClienteCadastroDto.Nascimento"
                    id="nasc">
            </mat-form-field>

            <mat-form-field floatLabel="floatLabel()" style="width: 8em;">
                <mat-label>SEXO</mat-label>
                <mat-select (keydown)="keydownSelectSexo($event);" #mySelectSexo
                    [(ngModel)]="dadosClienteCadastroDto.Sexo" required [(disabled)]="!cadastrando">
                    <mat-option>Selecione</mat-option>
                    <mat-option value="M">Masculino</mat-option>
                    <mat-option value="F">Feminino</mat-option>
                </mat-select>
            </mat-form-field>
        </span>
    </span>

    <span *ngIf="!cadastrando">
        <span class="caixa" *ngIf="ehPf()">
            <span class="rotulo">RG:</span> <span class="dado">{{dadosClienteCadastroDto.Rg}}</span>
            <span class="rotulo">Nascimento:</span> <span
                class="dado">{{DataUtilsFormatarTela(dadosClienteCadastroDto.Nascimento)}}</span>
            <span class="rotulo">Sexo:</span> <span class="dado">{{dadosClienteCadastroDto.Sexo}}</span>
        </span>
    </span>

    <div *ngIf="!cadastrando">
        <span class="caixa">
            <!-- ************   ENDEREÇO   ************  -->
            <span class="rotulo">Endereço:</span> <span
                class="dado">{{clienteCadastroUtils.formata_endereco(dadosClienteCadastroDto)}}</span>
        </span>
    </div>

    <div *ngIf="cadastrando">
        <app-cep #componenteCep></app-cep>
    </div>




    <div *ngIf="cadastrando">


        <!-- ************   TELEFONE RESIDENCIAL   ************  -->
        <!-- editamos na variável telefone e quem chamar precisa separar o DDD -->
        <div *ngIf="ehPf()">
            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="dadosClienteCadastroDto.TelefoneResidencial"
                    type="text" matInput placeholder="FONE RESIDENCIAL" maxlength="16" size="16" />
            </mat-form-field>

            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="dadosClienteCadastroDto.Celular" type="text"
                    matInput placeholder="CELULAR" maxlength="16" size="16" />
            </mat-form-field>

            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="dadosClienteCadastroDto.TelComercial"
                    type="text" matInput placeholder="FONE COMERCIAL" maxlength="16" size="16" />
            </mat-form-field>
            <mat-form-field floatLabel="floatLabel()" class="edicao-ramal">
                <input matInput type="text" placeholder="RAMAL" [(ngModel)]="dadosClienteCadastroDto.Ramal"
                    maxlength="4" size="6">
            </mat-form-field>

        </div>

        <!-- ************   TELEFONE COMERCIAL   ************  -->
        <div *ngIf="!ehPf()">
            <!-- editamos na variável telefone e quem chamar precisa separar o DDD -->
            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="dadosClienteCadastroDto.TelComercial"
                    type="text" matInput placeholder="TELEFONE 1" required maxlength="16" size="16" />
            </mat-form-field>
            <mat-form-field floatLabel="floatLabel()" class="edicao-ramal">
                <input matInput type="text" placeholder="RAMAL" [(ngModel)]="dadosClienteCadastroDto.Ramal"
                    maxlength="4" size="6">
            </mat-form-field>


            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="dadosClienteCadastroDto.TelComercial2"
                    type="text" matInput placeholder="TELEFONE 2" maxlength="16" size="16" />
            </mat-form-field>
            <mat-form-field floatLabel="floatLabel()" class="edicao-ramal">
                <input matInput type="text" placeholder="RAMAL" [(ngModel)]="dadosClienteCadastroDto.Ramal2"
                    maxlength="4" size="6">
            </mat-form-field>

        </div>

    </div>

    <div *ngIf="!cadastrando">
        <!-- ************   TELEFONE RESIDENCIAL   ************  -->
        <div *ngIf="ehPf()">
            <span class="caixa">
                <span class="rotulo">Telefones:</span>
                <span class="dado">{{clienteCadastroUtils.telefone1(dadosClienteCadastroDto)}}</span>
                <span class="dado">{{clienteCadastroUtils.telefone2(dadosClienteCadastroDto)}}</span>
                <span class="dado">{{clienteCadastroUtils.telefoneCelular(dadosClienteCadastroDto)}}</span>
            </span>
        </div>

        <div *ngIf="!ehPf()">
            <span class="caixa">
                <span class="rotulo">Telefones:</span>
                <span class="dado">{{clienteCadastroUtils.telefone1(dadosClienteCadastroDto)}}</span>
                <span class="dado">{{clienteCadastroUtils.telefone2(dadosClienteCadastroDto)}}</span>
            </span>
        </div>

    </div>

    <!-- ************   OBSERVAÇÃO (ANTIGO CAMPO FILIAÇÃO)   ************  -->
    <span *ngIf="ehPf()">
        <span *ngIf="cadastrando">
            <mat-form-field floatLabel="floatLabel()" *ngIf="ehPf()" class="largura-maxima-campo-formulario">
                <input matInput type="text" placeholder="OBSERVAÇÃO"
                    [(ngModel)]="dadosClienteCadastroDto.Observacao_Filiacao" maxlength="60">
            </mat-form-field>
        </span>
        <span *ngIf="!cadastrando">
            <div>
                <span class="caixa">
                    <span class="rotulo">Observação:</span>
                    <span class="dado">{{dadosClienteCadastroDto?.Observacao_Filiacao}} </span>
                </span>
            </div>
        </span>
    </span>

    <!--  ************   CONTATO   ************ -->
    <span *ngIf="!ehPf()">
        <span *ngIf="cadastrando">
            <mat-form-field floatLabel="floatLabel()" *ngIf="!ehPf()" class="largura-maxima-campo-formulario">
                <input matInput type="text" placeholder="NOME DA PESSOA PARA CONTATO NA EMPRESA"
                    [(ngModel)]="dadosClienteCadastroDto.Contato" required maxlength="30">
            </mat-form-field>
        </span>
        <span *ngIf="!cadastrando">
            <div>
                <span class="caixa">
                    <span class="rotulo">Nome da pessoa para contato na empresa:</span>
                    <span class="dado">{{dadosClienteCadastroDto?.Contato}}</span>
                </span>
            </div>
        </span>
    </span>

    <!-- ************   E-MAIL   ************  -->
    <span *ngIf="cadastrando">
        <mat-form-field floatLabel="floatLabel()" class="largura-maxima-campo-formulario">
            <input matInput type="text" placeholder="E-MAIL" [(ngModel)]="dadosClienteCadastroDto.Email" maxlength="60">
        </mat-form-field>
    </span>
    <span *ngIf="!cadastrando">
        <div>
            <span class="caixa">
                <span class="rotulo">E-mail:</span>
                <span class="dado">{{dadosClienteCadastroDto?.Email}}</span>
            </span>
        </div>
    </span>


    <!-- ************   E-MAIL (XML)  ************  -->
    <span *ngIf="cadastrando">
        <mat-form-field floatLabel="floatLabel()" class="largura-maxima-campo-formulario">
            <input matInput type="text" placeholder="E-MAIL (XML)" [(ngModel)]="dadosClienteCadastroDto.EmailXml"
                id="emailXml" maxlength="60">
        </mat-form-field>
    </span>
    <span *ngIf="!cadastrando">
        <div>
            <span class="caixa">
                <span class="rotulo">E-mail (xml):</span>
                <span class="dado">{{dadosClienteCadastroDto?.EmailXml}}</span>
            </span>
        </div>
    </span>


    <!-- ************   PRODUTOR RURAL / CONTRIBUINTE ICMS / IE ************  -->
    <!-- passamos apra o fim do formulário porque,. quando está confirnado um cliente já existente, os campos editáveis ficam no fim da tela -->
    <span *ngIf="ehPf()">
        <span *ngIf="editarIcms">
            <div>
                <!-- se está confirando, precisa de um espaço maior em cima -->
                <div *ngIf="!cadastrando" style="padding-top: 1.5em;"></div>
                <mat-form-field floatLabel="floatLabel()" [ngStyle]="{'padding':!cadastrando?'0em':''}">
                    <mat-label>PRODUTOR RURAL</mat-label>
                    <!-- produtor rural sempre é editável -->
                    <mat-select (keydown)="keydownSelectProdutor($event);" #mySelectProdutor required
                        [(ngModel)]="dadosClienteCadastroDto.ProdutorRural">
                        <mat-option>Selecione</mat-option>
                        <mat-option [(value)]="constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_NAO">Não</mat-option>
                        <mat-option [(value)]="constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM">Sim</mat-option>
                    </mat-select>
                </mat-form-field>

                <mat-form-field floatLabel="floatLabel()"
                    *ngIf="dadosClienteCadastroDto.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM"
                    style="width: 25ch;">
                    <input matInput type="text" placeholder="IE" [(ngModel)]="dadosClienteCadastroDto.Ie"
                        maxlength="20">
                </mat-form-field>

                <mat-form-field floatLabel="floatLabel()"
                    *ngIf="dadosClienteCadastroDto.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM"
                    style="width: 22ch;">
                    <mat-label>CONTRIBUINTE ICMS</mat-label>
                    <mat-select [(ngModel)]="dadosClienteCadastroDto.Contribuinte_Icms_Status">
                        <mat-option>Selecione</mat-option>
                        <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_NAO">Não</mat-option>
                        <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_SIM">Sim</mat-option>
                        <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_ISENTO">Isento</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </span>
        <span *ngIf="!editarIcms">
            <div>
                <span class="caixa">
                    <span class="rotulo">Produtor rural:</span>
                    <span class="dado">
                        {{dadosClienteCadastroDto?.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_NAO?"Não":""}}
                        {{dadosClienteCadastroDto?.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM?"Sim":""}}
                    </span>
                </span>
            </div>

            <span class="caixa"
                *ngIf="dadosClienteCadastroDto.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM">
                <span class="rotulo">IE:</span>
                <span class="dado"> {{dadosClienteCadastroDto?.Ie}} </span>
            </span>

            <span class="caixa"
                *ngIf="dadosClienteCadastroDto.ProdutorRural == constantes.COD_ST_CLIENTE_PRODUTOR_RURAL_SIM">
                <span class="rotulo">Contribuinte ICMS:</span>
                <span class="dado">
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_NAO?"Não":""}}
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_SIM?"Sim":""}}
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_ISENTO?"Isento":""}}
                </span>
            </span>
        </span>
    </span>

    <!-- campos específicos da pessoa jurídica -->
    <span *ngIf="!ehPf()">
        <span *ngIf="editarIcms">
            <!-- se está confirando, precisa de um espaço maior em cima -->
            <div *ngIf="!cadastrando" style="padding-top: 1.5em;"></div>

            <!-- IE sempre é editável -->
            <mat-form-field floatLabel="floatLabel()" style="width: 25ch;"
                [ngStyle]="{'padding':!cadastrando?'0em':''}">
                <input matInput type="text" placeholder="IE" [(ngModel)]="dadosClienteCadastroDto.Ie" maxlength="20">
            </mat-form-field>

            <mat-form-field floatLabel="floatLabel()" style="width: 22ch;">
                <mat-label>CONTRIBUINTE ICMS </mat-label>
                <mat-select required [(ngModel)]="dadosClienteCadastroDto.Contribuinte_Icms_Status">
                    <mat-option>Selecione</mat-option>
                    <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_NAO">Não
                    </mat-option>
                    <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_SIM">Sim
                    </mat-option>
                    <mat-option [(value)]="constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_ISENTO">
                        Isento</mat-option>
                </mat-select>
            </mat-form-field>

        </span>

        <span *ngIf="!editarIcms">
            <!-- IE sempre é editável -->
            <span class="caixa">
                <span class="rotulo">IE:</span>
                <span class="dado"> {{dadosClienteCadastroDto?.Ie}} </span>
            </span>

            <span class="caixa">
                <span class="rotulo">Contribuinte ICMS:</span>
                <span class="dado">
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_NAO?"Não":""}}
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_SIM?"Sim":""}}
                    {{dadosClienteCadastroDto?.Contribuinte_Icms_Status == constantes.COD_ST_CLIENTE_CONTRIBUINTE_ICMS_ISENTO?"Isento":""}}
                </span>
            </span>

        </span>

    </span>

    <!-- ************   REF BANCÁRIA   ************  -->
    <!-- ************   REF COMERCIAL   ************  -->
    <div *ngIf="!ehPf()">
        <!-- para visualização -->
        <ng-container *ngIf="!cadastrando">
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Referências
                    </mat-panel-title>
                    <mat-panel-description>
                        {{clienteCadastroDto.RefBancaria.length}} referência(s) bancária(s) e
                        {{clienteCadastroDto.RefComercial.length}} comercial(is)
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <!-- visualização de referência bancária, na PJ -->
                <ng-container *ngIf="clienteCadastroDto.RefBancaria.length == 0; else comRefBancaria">
                    <div class="caixa">
                        <span class="rotulo">Sem referências bancárias</span>
                        <span class="dado"> </span>
                    </div>
                </ng-container>
                <ng-template #comRefBancaria>
                    <div *ngFor="let ref of clienteCadastroDto.RefBancaria; let i = index">
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Referência bancária {{i+1}} </span>
                                <span class="dado"> </span>
                            </span>
                        </div>
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Banco: </span>
                                <span class="dado">{{ref.BancoDescricao}} </span>
                            </span>
                            <span class="caixa">
                                <span class="rotulo">Agência: </span>
                                <span class="dado">{{ref.Agencia}} </span>
                            </span>
                            <span class="caixa">
                                <span class="rotulo">Conta: </span>
                                <span class="dado">{{ref.Conta}} </span>
                            </span>
                            <span class="caixa">
                                <span class="rotulo">Telefone: </span>
                                <span class="dado">{{telefone_ddd_formata(ref.Telefone, ref.Ddd)}}</span>
                            </span>
                        </div>
                        <!-- contato em uma linha separada -->
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Contato: </span>
                                <span class="dado">{{ref.Contato}} </span>
                            </span>
                        </div>
                    </div>
                </ng-template>

                <!-- visualização de referência comercial -->
                <ng-container *ngIf="clienteCadastroDto.RefComercial.length == 0; else comRefCOmercial">
                    <div>
                        <span class="caixa">
                            <span class="rotulo">Sem referências comerciais</span>
                            <span class="dado"> </span>
                        </span>
                    </div>
                </ng-container>
                <ng-template #comRefCOmercial>
                    <div *ngFor="let ref of clienteCadastroDto.RefComercial; let i = index">
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Referência comercial {{i+1}} </span>
                                <span class="dado"> </span>
                            </span>
                        </div>
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Empresa: </span>
                                <span class="dado">{{ref.Nome_Empresa}} </span>
                            </span>
                            <span class="caixa">
                                <span class="rotulo">Contato: </span>
                                <span class="dado">{{ref.Contato}} </span>
                            </span>
                            <span class="caixa">
                                <span class="rotulo">Telefone: </span>
                                <span class="dado">{{telefone_ddd_formata(ref.Telefone, ref.Ddd)}}</span>
                            </span>
                        </div>
                    </div>
                </ng-template>
            </mat-expansion-panel>

        </ng-container>


        <!-- ************   REF BANCÁRIA   ************  -->
        <!-- ************   REF COMERCIAL   ************  -->
        <div *ngIf="!ehPf()">
            <!-- para criação -->
            <ng-container *ngIf="cadastrando">
                <!-- cadastro de referência bancária, na PJ -->

                <mat-expansion-panel [expanded]="true">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Referências bancárias ({{clienteCadastroDto.RefBancaria.length}})
                        </mat-panel-title>
                    </mat-expansion-panel-header>


                    <div style="width: 100%; text-align: right;">
                        <a mat-button title="Adicionar referência" (click)="adicionarRefBancaria()">
                            <mat-icon>add</mat-icon> Adicionar referência
                        </a>
                    </div>
                    <div *ngFor="let ref of clienteCadastroDto.RefBancaria; let i = index">
                        <hr style="height: 3px;
                        background: gray;
                        margin: 0px;
                        padding: 0px;
                        border: 0px;" />
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Referência bancária {{i+1}} <a mat-button
                                        title="Remover referência" (click)="removerRefBancaria(i)">
                                        <mat-icon>remove</mat-icon>
                                    </a> </span>
                                <span class="dado"> </span>
                            </span>
                        </div>
                        <div>

                            <mat-form-field floatLabel="floatLabel()">
                                <mat-label>BANCO</mat-label>
                                <mat-select required [(ngModel)]="ref.Banco">
                                    <mat-option>Selecione</mat-option>
                                    <mat-option *ngFor="let b of listaBancosCombo" [(value)]="b.Codigo">{{b.Codigo}} -
                                        {{b.Descricao}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field floatLabel="floatLabel()" style="width: 12ch;">
                                <input [(ngModel)]="ref.Agencia" type="text" matInput placeholder="AGÊNCIA" required
                                    maxlength="8" size="12" />
                            </mat-form-field>
                            <mat-form-field floatLabel="floatLabel()" style="width: 18ch;">
                                <input [(ngModel)]="ref.Conta" type="text" matInput placeholder="CONTA" required
                                    maxlength="12" size="16" />
                            </mat-form-field>


                            <!-- este editamos diretamente no telefone, e depois separamos o DD e o telefone -->
                            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="ref.Telefone" type="text"
                                    matInput placeholder="TELEFONE" maxlength="16" size="16" />
                            </mat-form-field>


                            <mat-form-field floatLabel="floatLabel()" class="largura-maxima-campo-formulario">
                                <input matInput type="text" placeholder="CONTATO" [(ngModel)]="ref.Contato"
                                    maxlength="60">
                            </mat-form-field>

                        </div>
                    </div>
                </mat-expansion-panel>

                <!-- cadastro de referência comercial, na PJ -->

                <mat-expansion-panel [expanded]="true">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Referências comerciais ({{clienteCadastroDto.RefComercial.length}})
                        </mat-panel-title>
                    </mat-expansion-panel-header>


                    <div style="width: 100%; text-align: right;">
                        <a mat-button title="Adicionar referência" (click)="adicionarRefComercial()">
                            <mat-icon>add</mat-icon> Adicionar referência
                        </a>
                    </div>
                    <div *ngFor="let ref of clienteCadastroDto.RefComercial; let i = index">
                        <hr style="height: 3px;
            background: gray;
            margin: 0px;
            padding: 0px;
            border: 0px;" />
                        <div>
                            <span class="caixa">
                                <span class="rotulo">Referência Comercial {{i+1}} <a mat-button
                                        title="Remover referência" (click)="removerRefComercial(i)">
                                        <mat-icon>remove</mat-icon>
                                    </a> </span>
                                <span class="dado"> </span>
                            </span>
                        </div>
                        <div>

                            <mat-form-field floatLabel="floatLabel()" class="largura-maxima-campo-formulario">
                                <input matInput type="text" placeholder="NOME DA EMPRESA" [(ngModel)]="ref.Nome_Empresa"
                                    required maxlength="60">
                            </mat-form-field>

                            <mat-form-field floatLabel="floatLabel()" class="largura-maxima-campo-formulario">
                                <input matInput type="text" placeholder="CONTATO" [(ngModel)]="ref.Contato"
                                    maxlength="40">
                            </mat-form-field>

                            <!-- este editamos diretamente no telefone, e depois separamos o DD e o telefone -->
                            <mat-form-field floatLabel="floatLabel()" class="edicao-telefone">
                                <input [textMask]="{mask: mascaraTelefone}" [(ngModel)]="ref.Telefone" type="text"
                                    matInput placeholder="TELEFONE" maxlength="16" size="16" />
                            </mat-form-field>

                        </div>
                    </div>
                </mat-expansion-panel>
            </ng-container>
        </div>



        <!-- 
            
            
            <comentario ************   REF BANCÁRIA   ************ comentario>
            <%if blnCadRefBancaria then%>
            <comentario  ASSEGURA CRIAÇÃO DE UM ARRAY DE CAMPOS, MESMO QUANDO HOUVER SOMENTE 1 LINHA!! comentario>
            <input type="hidden" name="c_RefBancariaBanco" id="c_RefBancariaBanco" value="">
            <input type="hidden" name="c_RefBancariaAgencia" id="c_RefBancariaAgencia" value="">
            <input type="hidden" name="c_RefBancariaConta" id="c_RefBancariaConta" value="">
            <input type="hidden" name="c_RefBancariaDdd" id="c_RefBancariaDdd" value="">
            <input type="hidden" name="c_RefBancariaTelefone" id="c_RefBancariaTelefone" value="">
            <input type="hidden" name="c_RefBancariaContato" id="c_RefBancariaContato" value="">
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    s="SELECT * FROM t_CLIENTE_REF_BANCARIA WHERE (id_cliente='" & Trim("" & rs("id")) & "') ORDER BY ordem"
                    set tRefBancaria = cn.Execute(s)
                    end if
                %>
                
                <% for intCounter=1 to int_MAX_REF_BANCARIA_CLIENTE %>
                    <%
                    strRefBancariaBanco=""
                    strRefBancariaAgencia=""
                    strRefBancariaConta=""
                    strRefBancariaDdd=""
                    strRefBancariaTelefone=""
                    strRefBancariaContato=""
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefBancaria.Eof then 
                            strRefBancariaBanco=Trim("" & tRefBancaria("banco"))
                            strRefBancariaAgencia=Trim("" & tRefBancaria("agencia"))
                            strRefBancariaConta=Trim("" & tRefBancaria("conta"))
                            strRefBancariaDdd=Trim("" & tRefBancaria("ddd"))
                            strRefBancariaTelefone=Trim("" & tRefBancaria("telefone"))
                            strRefBancariaContato=Trim("" & tRefBancaria("contato"))
                            end if
                        end if 
                    %>
            <% if Not eh_cpf then %>
            <br>
            <table width="649" cellpadding="0" cellspacing="0">
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">REFERÊNCIA BANCÁRIA<%if int_MAX_REF_BANCARIA_CLIENTE > 1 then Response.Write " (" & CStr(intCounter) & ")"%></p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td width="100%" class="MC" align="left">
                                    <p class="R">BANCO</p>
                                    <p class="C">
                                        <select name="c_RefBancariaBanco" id="c_RefBancariaBanco" <%=s_disabled%> style="margin:1px 10px 6px 10px;" onkeyup="if (window.event.keyCode==KEYCODE_DELETE) this.options[0].selected=true;">
                                        <%=banco_monta_itens_select(strRefBancariaBanco) %>
                                        </select>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MD" align="left">
                                    <p class="R">AGÊNCIA</p>
                                    <p class="C">
                                        <input name="c_RefBancariaAgencia" id="c_RefBancariaAgencia" <%=s_readonly%> class="TA" maxlength="8" size="12" value="<%=strRefBancariaAgencia%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefBancariaConta[<%=CStr(intCounter)%>].focus(); filtra_agencia_bancaria();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">CONTA</p>
                                    <p class="C">
                                        <input name="c_RefBancariaConta" id="c_RefBancariaConta" <%=s_readonly%> class="TA" maxlength="12" value="<%=strRefBancariaConta%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefBancariaDdd[<%=CStr(intCounter)%>].focus(); filtra_conta_bancaria();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">DDD</p>
                                    <p class="C">
                                        <input name="c_RefBancariaDdd" id="c_RefBancariaDdd" <%=s_readonly%> class="TA" maxlength="2" size="4" value="<%=strRefBancariaDdd%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefBancariaTelefone[<%=CStr(intCounter)%>].focus(); filtra_numerico();" onblur="if (!ddd_ok(this.value)) {alert('DDD inválido!!');this.focus();}">
                                    </p>
                                </td>
                                <td align="left">
                                    <p class="R">TELEFONE</p>
                                    <p class="C">
                                        <input name="c_RefBancariaTelefone" id="c_RefBancariaTelefone" <%=s_readonly%> class="TA" maxlength="9" value="<%=telefone_formata(strRefBancariaTelefone)%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefBancariaContato[<%=CStr(intCounter)%>].focus(); filtra_numerico();" onblur="if (!telefone_ok(this.value)) {alert('Telefone inválido!!');this.focus();} else this.value=telefone_formata(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">CONTATO</p>
                                    <p class="C">
                                        <input name="c_RefBancariaContato" id="c_RefBancariaContato" <%=s_readonly%> class="TA" maxlength="40"  style="width:600px;" value="<%=strRefBancariaContato%>" onkeypress="if (digitou_enter(true)) {if (<%=CStr(intCounter+1)%>==fCAD.c_RefBancariaAgencia.length) this.focus(); else fCAD.c_RefBancariaAgencia[<%=CStr(intCounter+1)%>].focus();} filtra_nome_identificador();">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <% end if %>
                    <% 
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefBancaria.Eof then tRefBancaria.MoveNext
                        end if
                    %>
                    
                <% next %>
                
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    tRefBancaria.Close
                    end if
                %>
            <%end if%>
            
            

            <comentario ************   REF COMERCIAL   ************ comentario>
            <%if blnCadRefComercial then%>
            <comentario  ASSEGURA CRIAÇÃO DE UM ARRAY DE CAMPOS, MESMO QUANDO HOUVER SOMENTE 1 LINHA!! comentario>
            <input type="hidden" name="c_RefComercialNomeEmpresa" id="c_RefComercialNomeEmpresa" value="">
            <input type="hidden" name="c_RefComercialContato" id="c_RefComercialContato" value="">
            <input type="hidden" name="c_RefComercialDdd" id="c_RefComercialDdd" value="">
            <input type="hidden" name="c_RefComercialTelefone" id="c_RefComercialTelefone" value="">
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    s="SELECT * FROM t_CLIENTE_REF_COMERCIAL WHERE (id_cliente='" & Trim("" & rs("id")) & "') ORDER BY ordem"
                    set tRefComercial = cn.Execute(s)
                    end if
                %>
                
                <% for intCounter=1 to int_MAX_REF_COMERCIAL_CLIENTE %>
                    <%
                    strRefComercialNomeEmpresa=""
                    strRefComercialContato=""
                    strRefComercialDdd=""
                    strRefComercialTelefone=""
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefComercial.Eof then 
                            strRefComercialNomeEmpresa=Trim("" & tRefComercial("nome_empresa"))
                            strRefComercialContato=Trim("" & tRefComercial("contato"))
                            strRefComercialDdd=Trim("" & tRefComercial("ddd"))
                            strRefComercialTelefone=Trim("" & tRefComercial("telefone"))
                            end if
                        end if 
                    %>
            <br>
            <table width="649" cellpadding="0" cellspacing="0">
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">REFERÊNCIA COMERCIAL<%if int_MAX_REF_COMERCIAL_CLIENTE > 1 then Response.Write " (" & CStr(intCounter) & ")"%></p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td width="100%" class="MC" align="left">
                                    <p class="R">NOME DA EMPRESA</p>
                                    <p class="C">
                                        <input name="c_RefComercialNomeEmpresa" id="c_RefComercialNomeEmpresa" <%=s_readonly%> class="TA" maxlength="60"  style="width:600px;" value="<%=strRefComercialNomeEmpresa%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefComercialContato[<%=CStr(intCounter)%>].focus(); filtra_nome_identificador();">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MD" align="left">
                                    <p class="R">CONTATO</p>
                                    <p class="C">
                                        <input name="c_RefComercialContato" id="c_RefComercialContato" <%=s_readonly%> class="TA" maxlength="40" value="<%=strRefComercialContato%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefComercialDdd[<%=CStr(intCounter)%>].focus(); filtra_nome_identificador();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">DDD</p>
                                    <p class="C">
                                        <input name="c_RefComercialDdd" id="c_RefComercialDdd" <%=s_readonly%> class="TA" maxlength="2" size="4" value="<%=strRefComercialDdd%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefComercialTelefone[<%=CStr(intCounter)%>].focus(); filtra_numerico();" onblur="if (!ddd_ok(this.value)) {alert('DDD inválido!!');this.focus();}">
                                    </p>
                                </td>
                                <td align="left">
                                    <p class="R">TELEFONE</p>
                                    <p class="C">
                                        <input name="c_RefComercialTelefone" id="c_RefComercialTelefone" <%=s_readonly%> class="TA" maxlength="9" value="<%=telefone_formata(strRefComercialTelefone)%>" onkeypress="if (digitou_enter(true)) {if (<%=CStr(intCounter+1)%>==fCAD.c_RefComercialNomeEmpresa.length) this.focus(); else fCAD.c_RefComercialNomeEmpresa[<%=CStr(intCounter+1)%>].focus();} filtra_numerico();" onblur="if (!telefone_ok(this.value)) {alert('Telefone inválido!!');this.focus();} else this.value=telefone_formata(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
                    <% 
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefComercial.Eof then tRefComercial.MoveNext
                        end if
                    %>
                    
                <% next %>
                
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    tRefComercial.Close
                    end if
                %>
            <%end if%>
            
            

            
            <comentario ************   FORM PARA OPÇÃO DE CADASTRAR NOVO ORÇAMENTO?  ************ comentario>

                este estamos fazendo em outra tela, na confirmar-cliente.component.ts


            <% if operacao_selecionada = OP_CONSULTA then %>
                <% if isLojaHabilitadaProdCompostoECommerce(loja) then
                        s_dest = "OrcamentoNovoProdCompostoMask.asp"
                    else
                        s_dest = "OrcamentoNovo.asp"
                    end if %>
                <form action="<%=s_dest%>" method="post" id="fORC" name="fORC" onsubmit="if (!fORCConcluir(fORC)) return false">
                <input type="hidden" name="cliente_selecionado" id="cliente_selecionado" value='<%=id_cliente%>'>
                <input type="hidden" name="operacao_selecionada" id="operacao_selecionada" value='<%=OP_INCLUI%>'>
                <input type="hidden" name="c_FormFieldValues" id="c_FormFieldValues" value="" />
            
            <comentario ************   ENDEREÇO DE ENTREGA: S/N   ************ comentario>
            <br>
            <table width="649" class="Q" cellspacing="0">
                <tr>
                    <td align="left">
                    <p class="R">ENDEREÇO DE ENTREGA</p><p class="C">
                        <% intIdx = 0 %>
                        <input type="radio" id="rb_end_entrega_nao" name="rb_end_entrega" value="N" onclick="Disabled_True(fORC);"><span class="C" style="cursor:default" onclick="fORC.rb_end_entrega[<%=Cstr(intIdx)%>].click();Disabled_True(fORC);">O mesmo endereço do cadastro</span>
                        <% intIdx = intIdx + 1 %>
                        <br><input type="radio" id="rb_end_entrega_sim" name="rb_end_entrega" value="S" onclick="Disabled_False(fORC);"><span class="C" style="cursor:default" onclick="fORC.rb_end_entrega[<%=Cstr(intIdx)%>].click();Disabled_False(fORC);">Outro endereço</span>
                    </p>
                    </td>
                </tr>
            </table>
            
            <comentario ************   ENDEREÇO DE ENTREGA: ENDEREÇO   ************ comentario>
            <table width="649" class="QS" cellspacing="0">
                <tr>
                <td width="100%" align="left"><p class="R">ENDEREÇO</p><p class="C">
                    <input id="EndEtg_endereco" name="EndEtg_endereco" class="TA" value="" maxlength="60" style="width:635px;" onkeypress="if (digitou_enter(true) && tem_info(this.value)) fORC.EndEtg_endereco_numero.focus(); filtra_nome_identificador();"></p></td>
                </tr>
            </table>
            
            <comentario ************   ENDEREÇO DE ENTREGA: Nº/COMPLEMENTO   ************ comentario>
            <table width="649" class="QS" cellspacing="0">
                <tr>
                <td class="MD" width="50%" align="left"><p class="R">Nº</p><p class="C">
                    <input id="EndEtg_endereco_numero" name="EndEtg_endereco_numero" class="TA" value="" maxlength="20" style="width:310px;" onkeypress="if (digitou_enter(true) && tem_info(this.value)) fORC.EndEtg_endereco_complemento.focus(); filtra_nome_identificador();"></p></td>
                <td width="50%" align="left"><p class="R">COMPLEMENTO</p><p class="C">
                    <input id="EndEtg_endereco_complemento" name="EndEtg_endereco_complemento" class="TA" value="" maxlength="60" style="width:310px;" onkeypress="if (digitou_enter(true) && tem_info(this.value)) fORC.EndEtg_bairro.focus(); filtra_nome_identificador();"></p></td>
                </tr>
            </table>
            
            <comentario ************   ENDEREÇO DE ENTREGA: BAIRRO/CIDADE   ************ comentario>
            <table width="649" class="QS" cellspacing="0">
                <tr>
                <td class="MD" width="50%" align="left"><p class="R">BAIRRO</p><p class="C">
                    <input id="EndEtg_bairro" name="EndEtg_bairro" class="TA" value="" maxlength="72" style="width:310px;" onkeypress="if (digitou_enter(true) && tem_info(this.value)) fORC.EndEtg_cidade.focus(); filtra_nome_identificador();"></p></td>
                <td width="50%" align="left"><p class="R">CIDADE</p><p class="C">
                    <input id="EndEtg_cidade" name="EndEtg_cidade" class="TA" value="" maxlength="60" style="width:310px;" onkeypress="if (digitou_enter(true) && tem_info(this.value)) fORC.EndEtg_uf.focus(); filtra_nome_identificador();"></p></td>
                </tr>
            </table>
            
            <comentario ************   ENDEREÇO DE ENTREGA: UF/CEP   ************ comentario>
            <table width="649" class="QS" cellspacing="0">
                <tr>
                <td width="50%" class="MD" align="left"><p class="R">UF</p><p class="C">
                    <input id="EndEtg_uf" name="EndEtg_uf" class="TA" value="" maxlength="2" size="3" onkeypress="if (digitou_enter(true) && tem_info(this.value) && uf_ok(this.value)) fORC.EndEtg_cep.focus();" onblur="this.value=trim(this.value); if (!uf_ok(this.value)) {alert('UF inválida!!');this.focus();} else this.value=ucase(this.value);"></p></td>
                <td width="50%" align="left">
                    <table width="100%" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="50%" align="left"><p class="R">CEP</p><p class="C">
                            <input id="EndEtg_cep" name="EndEtg_cep" readonly tabindex=-1 class="TA" value="" maxlength="9" size="11" onkeypress="if (digitou_enter(true) && cep_ok(this.value)) filtra_cep();" onblur="if (!cep_ok(this.value)) {alert('CEP inválido!!');this.focus();} else this.value=cep_formata(this.value);"></p></td>
                        <td align="center" width="50%">
                            <% if blnPesquisaCEPAntiga then %>
                            <button type="button" name="bPesqCepEndEtg" id="bPesqCepEndEtg" style='width:130px;font-size:10pt;' class="Botao" onclick="AbrePesquisaCepEndEtg();">Pesquisar CEP</button>
                            <% end if %>
                            <% if blnPesquisaCEPAntiga and blnPesquisaCEPNova then Response.Write "&nbsp;" %>
                            <% if blnPesquisaCEPNova then %>
                            <button type="button" name="bPesqCepEndEtgNovo" id="bPesqCepEndEtgNovo" style='width:130px;font-size:10pt;' class="Botao" onclick="exibeJanelaCEP_Etg();">&nbsp;Busca de CEP&nbsp;</button>
                            <% end if %>
                        </td>
                    </tr>
                    </table>
                </td>
                </tr>
            </table>
            <comentario ************   JUSTIFIQUE O ENDEREÇO   ************ comentario>
            <table id="obs_endereco" width="649" class="QS" cellspacing="0">
                <tr >
                <td class="M" width="50%" align="left"><p class="R">JUSTIFIQUE O ENDEREÇO</p><p class="C">
                    <select id="EndEtg_obs" name="EndEtg_obs" style="margin-right:225px;">			
                         <%=codigo_descricao_monta_itens_select_por_loja(GRUPO_T_CODIGO_DESCRICAO__ENDETG_JUSTIFICATIVA, "", loja)%>
                    </select></td>
                </tr>
            </table>
                </form>
                </form>
            <% end if %>
            
            
            
            <comentario ************   SEPARADOR   ************ comentario>
            <table width="698" cellpadding="4" cellspacing="0" style="border-bottom:1px solid black">
            <tr><td class="Rc" align="left">&nbsp;</td></tr>
            </table>
            <br>
            
            
            <table class="notPrint" width="649" cellspacing="0">
            <tr>
                <td align="left"><a href="javascript:history.back();" title="volta para a página anterior">
                    <img src="../botao/voltar.gif" width="176" height="55" border="0"></a></td>
            
            <% if (operacao_selecionada = OP_CONSULTA) Or blnEdicaoBloqueada then %>
                <td align="center"><div name="dATUALIZACONTRIB" id="dATUALIZACONTRIB">
                    <a name="bATUALIZA" id="bATUALIZACONTRIB" href="javascript:AtualizaClienteContrib(fCAD)" title="atualiza o cadastro deste cliente">
                    <img src="../botao/confirmar.gif" width="176" height="55" border="0"></a></div>
                </td>
                <td align="right"><div name="dORCAMENTO" id="dORCAMENTO">
                    <a name="bORCAMENTO" id="bORCAMENTO" href="javascript:fORCConcluir(fORC);" title="cadastra um novo pré-pedido para este cliente">
                    <img src="../botao/orcamento.gif" width="176" height="55" border="0"></a></div>
                </td>
            <% else %>
                <td align="right"><div name="dATUALIZA" id="dATUALIZA">
                    <a name="bATUALIZA" id="bATUALIZA" href="javascript:AtualizaCliente(fCAD)" title="atualiza o cadastro deste cliente">
                    <img src="../botao/confirmar.gif" width="176" height="55" border="0"></a></div>
                </td>
            <% end if %>
                
            </tr>
            </table>
            
            </center>
            </body>
            </html>  -->


        <!-- ************   EXIBE OBSERVAÇÕES CREDITÍCIAS?  ************
    está com display:none!
    <div *ngIf="!cadastrando">
        <div *ngIf="dadosClienteCadastroDto_obs_crediticias() !== ''">
            <span class="Lbl" style="display:none">OBSERVAÇÕES CREDITÍCIAS</span>
            <div class='MtAviso' style="width:649px;FONT-WEIGHT:bold;border:1pt solid black;display:none;" align="CENTER">
                <p style='margin:5px 2px 5px 2px;'>{{dadosClienteCadastroDto_obs_crediticias}}</p>
            </div>
            <br>
        </div>
    </div> -->

        <!-- <comentario ************   OBS CREDITÍCIAS (INATIVO)  ************ comentario>
            <table width="649" class="QS" cellspacing="0" style="display:none">
                <tr>
                <td width="100%" align="left"><p class="R">OBSERVAÇÕES CREDITÍCIAS</p><p class="C">
                    <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("obs_crediticias")) else s=""%>
                    <input id="obs_crediticias" name="obs_crediticias" <%=s_readonly%> class="TA" value="<%=s%>" maxlength="50" size="65" onkeypress="if (digitou_enter(true)) fCAD.midia.focus(); filtra_nome_identificador();"></p></td>
                </tr>
            </table>
            
            <comentario ************   MÍDIA (INATIVO)  ************ comentario>
            <table width="649" class="QS" cellspacing="0" style="display:none">
                <tr>
                <td width="100%" align="left"><p class="R">FORMA PELA QUAL CONHECEU A BONSHOP</p><p class="C">
                    <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("midia")) else s=""%>
                    <select id="midia" name="midia" <%=s_disabled%> style="margin-top:4pt; margin-bottom:4pt;">
                        <%=midia_monta_itens_select(s)%>
                    </select>
                </tr>
            </table>

            <comentario ************   REF PROFISSIONAL (INATIVO)   ************ comentario>
            <%if blnCadRefProfissional then%>
            <comentario  ASSEGURA CRIAÇÃO DE UM ARRAY DE CAMPOS, MESMO QUANDO HOUVER SOMENTE 1 LINHA!! comentario>
            <input type="hidden" name="c_RefProfNomeEmpresa" id="c_RefProfNomeEmpresa" value="">
            <input type="hidden" name="c_RefProfCargo" id="c_RefProfCargo" value="">
            <input type="hidden" name="c_RefProfDdd" id="c_RefProfDdd" value="">
            <input type="hidden" name="c_RefProfTelefone" id="c_RefProfTelefone" value="">
            <input type="hidden" name="c_RefProfPeriodoRegistro" id="c_RefProfPeriodoRegistro" value="">
            <input type="hidden" name="c_RefProfRendimentos" id="c_RefProfRendimentos" value="">
            <input type="hidden" name="c_RefProfCnpj" id="c_RefProfCnpj" value="">
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    s="SELECT * FROM t_CLIENTE_REF_PROFISSIONAL WHERE (id_cliente='" & Trim("" & rs("id")) & "') ORDER BY ordem"
                    set tRefProfissional = cn.Execute(s)
                    end if
                %>
                
                <% for intCounter=1 to int_MAX_REF_PROFISSIONAL_CLIENTE %>
                    <%
                    strRefProfNomeEmpresa=""
                    strRefProfCargo=""
                    strRefProfDdd=""
                    strRefProfTelefone=""
                    strRefProfPeriodoRegistro=""
                    strRefProfRendimentos=""
                    strRefProfCnpj=""
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefProfissional.Eof then 
                            strRefProfNomeEmpresa=Trim("" & tRefProfissional("nome_empresa"))
                            strRefProfCargo=Trim("" & tRefProfissional("cargo"))
                            strRefProfDdd=Trim("" & tRefProfissional("ddd"))
                            strRefProfTelefone=Trim("" & tRefProfissional("telefone"))
                            strRefProfPeriodoRegistro=formata_data(tRefProfissional("periodo_registro"))
                            strRefProfRendimentos=formata_moeda(tRefProfissional("rendimentos"))
                            strRefProfCnpj=cnpj_cpf_formata(Trim("" & tRefProfissional("cnpj")))
                            end if
                        end if 
                    %>
            
            <table width="649" cellpadding="0" cellspacing="0" style="display:none">
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">REFERÊNCIA PROFISSIONAL<%if int_MAX_REF_PROFISSIONAL_CLIENTE > 1 then Response.Write " (" & CStr(intCounter) & ")"%></p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MC MD" align="left">
                                    <p class="R">NOME DA EMPRESA</p>
                                    <p class="C">
                                        <input name="c_RefProfNomeEmpresa" id="c_RefProfNomeEmpresa" <%=s_readonly%> class="TA" maxlength="60"  style="width:450px;" value="<%=strRefProfNomeEmpresa%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefProfCnpj[<%=CStr(intCounter)%>].focus(); filtra_nome_identificador();">
                                    </p>
                                </td>
                                <td class="MC" align="left">
                                    <p class="R">CNPJ</p>
                                    <p class="C">
                                        <input name="c_RefProfCnpj" id="c_RefProfCnpj" <%=s_readonly%> class="TA" maxlength="18"  size="24" value="<%=strRefProfCnpj%>" onkeypress="if (digitou_enter(true) && cnpj_ok(this.value)) fCAD.c_RefProfCargo[<%=CStr(intCounter)%>].focus(); filtra_cnpj();" onblur="if (!cnpj_ok(this.value)) {alert('CNPJ inválido'); this.focus();} else this.value=cnpj_formata(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MD" align="left">
                                    <p class="R">CARGO</p>
                                    <p class="C">
                                        <input name="c_RefProfCargo" id="c_RefProfCargo" <%=s_readonly%> class="TA" maxlength="40" style="width:350px;" value="<%=strRefProfCargo%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefProfDdd[<%=CStr(intCounter)%>].focus(); filtra_nome_identificador();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">DDD</p>
                                    <p class="C">
                                        <input name="c_RefProfDdd" id="c_RefProfDdd" <%=s_readonly%> class="TA" maxlength="2" size="4" value="<%=strRefProfDdd%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefProfTelefone[<%=CStr(intCounter)%>].focus(); filtra_numerico();" onblur="if (!ddd_ok(this.value)) {alert('DDD inválido!!');this.focus();}">
                                    </p>
                                </td>
                                <td align="left">
                                    <p class="R">TELEFONE</p>
                                    <p class="C">
                                        <input name="c_RefProfTelefone" id="c_RefProfTelefone" <%=s_readonly%> class="TA" maxlength="9" value="<%=telefone_formata(strRefProfTelefone)%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefProfPeriodoRegistro[<%=CStr(intCounter)%>].focus(); filtra_numerico();" onblur="if (!telefone_ok(this.value)) {alert('Telefone inválido!!');this.focus();} else this.value=telefone_formata(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MD" width="50%" align="left">
                                    <p class="R">REGISTRADO DESDE (DD/MM/AAAA)</p>
                                    <p class="C">
                                        <input name="c_RefProfPeriodoRegistro" id="c_RefProfPeriodoRegistro" <%=s_readonly%> class="TA" maxlength="10" value="<%=strRefProfPeriodoRegistro%>" onkeypress="if (digitou_enter(true)) fCAD.c_RefProfRendimentos[<%=CStr(intCounter)%>].focus(); filtra_data();" onblur="if (!isDate(this)) {alert('Data inválida!!');this.focus();}">
                                    </p>
                                </td>
                                <td width="50%" align="left">
                                    <p class="R">RENDIMENTOS (<%=SIMBOLO_MONETARIO%>)</p>
                                    <p class="C">
                                        <input name="c_RefProfRendimentos" id="c_RefProfRendimentos" <%=s_readonly%> class="TA" maxlength="18" value="<%=strRefProfRendimentos%>" onkeypress="if (digitou_enter(true)) {if (<%=CStr(intCounter+1)%>==fCAD.c_RefProfNomeEmpresa.length) this.focus(); else fCAD.c_RefProfNomeEmpresa[<%=CStr(intCounter+1)%>].focus();} filtra_moeda_positivo();" onblur="this.value=formata_moeda(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
                    <% 
                    if (operacao_selecionada=OP_CONSULTA) then
                        if Not tRefProfissional.Eof then tRefProfissional.MoveNext
                        end if
                    %>
                    
                <% next %>
                
                <% 
                if operacao_selecionada=OP_CONSULTA then
                    tRefProfissional.Close
                    end if
                %>
            <%end if%>
            
            <comentario ************   PJ: DADOS DO SÓCIO MAJORITÁRIO (INATIVO)  ************ comentario>
            <%if blnCadSocioMaj then%>
            <table width="649" cellpadding="0" cellspacing="0" style="display:none">
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">DADOS DO SÓCIO MAJORITÁRIO</p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                            <td class="MC MD" width="85%" align="left"><p class="R">NOME</p><p class="C">
                                <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_Nome")) else s=""%>
                                <input id="c_SocioMajNome" name="c_SocioMajNome" <%=s_readonly%> class="TA" value="<%=s%>" maxlength="60" size="61" onkeypress="if (digitou_enter(true)) fCAD.c_SocioMajCpf.focus(); filtra_nome_identificador();" onblur="this.value=trim(this.value);"></p></td>
                            <td class="MC" align="left"><p class="R">CPF</p><p class="C">
                                <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_CPF")) else s=""%>
                                <input id="c_SocioMajCpf" name="c_SocioMajCpf" <%=s_readonly%> class="TA" value="<%=cnpj_cpf_formata(s)%>" maxlength="14" size="15" onkeypress="if (digitou_enter(true) && cpf_ok(this.value)) fCAD.c_SocioMajBanco.focus(); filtra_numerico();" onblur="if (!cpf_ok(this.value)) {alert('CPF inválido!!');this.focus();} else this.value=cnpj_cpf_formata(this.value);"></p></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">BANCO</p>
                                    <p class="C">
                                        <select name="c_SocioMajBanco" id="c_SocioMajBanco" <%=s_disabled%> style="margin:1px 10px 6px 10px;" onkeyup="if (window.event.keyCode==KEYCODE_DELETE) this.options[0].selected=true;">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_banco")) else s=""%>
                                        <%=banco_monta_itens_select(s) %>
                                        </select>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td class="MD" align="left">
                                    <p class="R">AGÊNCIA</p>
                                    <p class="C">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_agencia")) else s=""%>
                                        <input name="c_SocioMajAgencia" id="c_SocioMajAgencia" <%=s_readonly%> class="TA" maxlength="8" value="<%=s%>" onkeypress="if (digitou_enter(true)) fCAD.c_SocioMajConta.focus(); filtra_agencia_bancaria();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">CONTA</p>
                                    <p class="C">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_conta")) else s=""%>
                                        <input name="c_SocioMajConta" id="c_SocioMajConta" <%=s_readonly%> class="TA" maxlength="12" value="<%=s%>" onkeypress="if (digitou_enter(true)) fCAD.c_SocioMajDdd.focus(); filtra_conta_bancaria();">
                                    </p>
                                </td>
                                <td class="MD" align="left">
                                    <p class="R">DDD</p>
                                    <p class="C">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_ddd")) else s=""%>
                                        <input name="c_SocioMajDdd" id="c_SocioMajDdd" <%=s_readonly%> class="TA" maxlength="2" size="4" value="<%=s%>" onkeypress="if (digitou_enter(true)) fCAD.c_SocioMajTelefone.focus(); filtra_numerico();" onblur="if (!ddd_ok(this.value)) {alert('DDD inválido!!');this.focus();}">
                                    </p>
                                </td>
                                <td align="left">
                                    <p class="R">TELEFONE</p>
                                    <p class="C">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_telefone")) else s=""%>
                                        <input name="c_SocioMajTelefone" id="c_SocioMajTelefone" <%=s_readonly%> class="TA" maxlength="9" value="<%=telefone_formata(s)%>" onkeypress="if (digitou_enter(true)) fCAD.c_SocioMajContato.focus(); filtra_numerico();" onblur="if (!telefone_ok(this.value)) {alert('Telefone inválido!!');this.focus();} else this.value=telefone_formata(this.value);">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td width="100%" align="left">
                        <table width="100%" class="QS" cellspacing="0">
                            <tr>
                                <td width="100%" align="left">
                                    <p class="R">CONTATO</p>
                                    <p class="C">
                                        <%if operacao_selecionada=OP_CONSULTA then s=Trim("" & rs("SocMaj_contato")) else s=""%>
                                        <input name="c_SocioMajContato" id="c_SocioMajContato" <%=s_readonly%> class="TA" maxlength="40"  style="width:600px;" value="<%=s%>" onkeypress="filtra_nome_identificador();">
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <%end if%>
            
            </form>
                                    
             -->

    </div>