<section [ngClass]="{'sectionDesktop': telaDesktop, 'sectionCelular': !telaDesktop}">
    <form>
        <!-- este é melhor deixar sem o carregando, fica muito confuso na tela pq pisca demais.... -->
        <!-- [ngClass]="{'carregando': carregando && digitado !== ''}" -->
        <article mat-dialog-content class="fixo">
            <!-- este fica ruim: div style="display: flex; " [ngStyle]="{'flex-direction':telaDesktop?'row':'column'}" -->
            <div style="display: flex; flex-direction: row; ">
                <mat-form-field style="flex-grow: 1; flex-shrink: 1;">
                    <input matInput type="text" name="buscaproduto" placeholder="Produto (código ou descrição)"
                        value="{{this.selecProdInfoPassado.Produto}}" (change)="digitouProd($event)"
                        (keyup)="digitouProd($event)" [autofocus]="true" #digitadocx>
                </mat-form-field>

                <mat-form-field style="flex-grow: 0; flex-shrink: 0; width: 8ch;">
                    <input matInput type="number" name="qte" placeholder="Quantidade" required [(ngModel)]="qdte"
                        [ngModelOptions]="{standalone: true}">
                </mat-form-field>
            </div>
            <div class="listaprods">
                <div *ngIf="telaDesktop">Afazer: verificar se o retorno da API está correto (se está listando somente os
                    produtos disponíveis para venda). </div>
                <mat-radio-group aria-label="Selecione o produto" [(ngModel)]="produto" required
                    [ngModelOptions]="{standalone: true}">
                    <table style="width: 100%;" class="destaquelinha">
                        <ng-container *ngFor="let p of prods">
                            <tr [ngStyle]="{display: p.visivel ? '':'none'}" class="prod">
                                <td class="tdtabela">
                                    <!-- usamos o display: none e não o ngif para ficar mais rápido:
                        quando o usuário pede para editar uma linha existente, se ele apagar o código do produto na caixa de texto
                        fica lento porque tem que reconstruir a árvore -->
                                    <div>
                                        <!-- usar o mat-radio-button fica BEM mais lento!!
        mas paree que a veocidade está suficiente... porque fizemos o truque de passar somente X registros por atualizacao, na rotina maisDadosProd
        no celular, vamos usar só o checkbox mesmo
         -->
                                        <mat-radio-button *ngIf="telaDesktop" type="radio" name="produto"
                                            value="{{ProdutoTelaFabrProd(p.produtoDto.Fabricante, p.produtoDto.Produto)}}">
                                            {{ProdutoTelaFabrProd(p.produtoDto.Fabricante, p.produtoDto.Produto)}}
                                        </mat-radio-button>
                                        <label>
                                            <input *ngIf="!telaDesktop" type="radio" name="produto"
                                                value="{{ProdutoTelaFabrProd(p.produtoDto.Fabricante, p.produtoDto.Produto)}}"
                                                [(ngModel)]="produto">
                                            {{ProdutoTelaFabrProd(p.produtoDto.Fabricante, p.produtoDto.Produto)}}
                                        </label>

                                        <!-- no celular, nao temos a coluan de descrição, colocamos na mesma coluna -->
                                        <span *ngIf="!telaDesktop" [innerHTML]="p.produtoDto.Descricao_html"></span>

                                    </div>
                                </td>
                                <td class="tdtabela" *ngIf="telaDesktop">
                                    <span [innerHTML]="p.produtoDto.Descricao_html"></span> </td>
                                <td class="tdtabela" align="right">
                                    {{moedaUtils.formatarMoedaComPrefixo(p.produtoDto.Preco_lista)}}
                                </td>
                            </tr>
                            <!-- filhos -->
                            <tr [ngStyle]="{display: p.visivel ? '':'none'}" class="prod trfilho"
                                *ngFor="let f of p.Filhos">
                                <td class="itemfilho">
                                    {{f.Qtde}} x {{ProdutoTelaFabrProd(f.Fabricante, f.Produto)}}
                                    <span *ngIf="!telaDesktop"
                                        innerHTML="{{produtoDescr(f.Fabricante, f.Produto).Descricao_html}}"></span>
                                </td>
                                <td class="tdtabela" *ngIf="telaDesktop">
                                    <span innerHTML="{{produtoDescr(f.Fabricante, f.Produto).Descricao_html}}"></span>
                                </td>
                                <td class="tdtabela" align="right">
                                    {{moedaUtils.formatarMoedaComPrefixo(produtoDescr(f.Fabricante, f.Produto).Preco_lista * f.Qtde)}}
                                </td>
                            </tr>

                        </ng-container>
                    </table>
                </mat-radio-group>
            </div>


        </article>
        <footer mat-dialog-actions style="justify-content: space-around;">
            <button mat-raised-button (click)="onAdicionarClick()" color="accent">
                <ng-template *ngIf="selecProdInfoPassado.Produto; then modificarBlock else adicionarBlock">
                </ng-template>
                <ng-template #modificarBlock>Modificar</ng-template>
                <ng-template #adicionarBlock>Adicionar</ng-template>
            </button>
            <button mat-raised-button (click)="onNoClick()" cdkFocusInitial color="accent">Cancelar</button>
        </footer>
    </form>
</section>