@model Loja.UI.Models.Produtos.ConsultaProdutosViewModel
@{
    ViewData["Title"] = "BuscaListaProdutosFabricante";
}

<script>

    function testeModal() {
        let Modalelem = document.querySelector('.modal');
        let instanceModal = M.Modal.init(Modalelem);
        instanceModal.open();
    };
</script>

<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 px-0">
    @if (Model != null)
    {
        @if (Model.Fabricante != null)
        {
            <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12 px-0">
                <h5>
                    Lista de Produtos -
                    <span style="font-weight: bold">
                        @Model.Fabricante
                    </span>
                </h5>
                <partial name="~/Views/Shared/Datatables.cshtml" />
            </div>







            <script>
                $(document).ready(function () {
                    intiDatatables('#tabela', {
                        columnDefs: [
                            { type: "moeda", targets: 2 }
                        ]
                    });
                });
            </script>


            <table id="tabela" style="display: none;">
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Descrição</th>
                        <th class="right-align">Preço</th>
                    </tr>
                </thead>


                <tbody>

                    @foreach (var item in Model.LstProdutos)
                    {
                        <tr>
                            <td>@item.Produto</td>
                            <td>@item.Descricao</td>
                            <td class="right-align">@Loja.Bll.Util.Util.FormataMoeda(item.Preco)</td>
                        </tr>

                    }
                </tbody>

            </table>
            <div class="content">
                <div class="form-group mt-2" style="text-align:right">
                    <button class="btn btn-primary"
                            onclick="Imprimir()">
                        Imprimir
                    </button>
                </div>
            </div>
        }
        else
        {
            <script>
                $(document).ready(function () {
                    ModalSimples("Erro", "Fabricante não encontrado!");
                });
            </script>
        }
    }




    @* Impressão *@
    @if (Model != null)
    {
        @if (Model.Fabricante != null)
        {
            <table id="tabelateste" style="visibility:collapse;
                               width:649px;
                               border-right:1pt solid #C0C0C0;
                               border-bottom:1pt solid #c0c0c0;
                               font-family:Arial, Helvetica, sans-serif;
                               font-size:10pt;
                               border-left:1pt solid #c0c0c0;"
                   cellpadding="4"
                   class="table-responsive">
                <tbody>
                    <tr>
                        <td align="center" style="background-color:azure;
                                      background-size:auto;
                                      background-origin:padding-box;
                                      background-clip:border-box;
                                      border-top:1pt solid #C0C0C0;
                                      border-bottom:1pt solid #C0C0C0"
                            colspan="3">
                            <p style="color:#000000;
                          font-size:9pt;
                          font-weight:bold;
                          font-style:normal;
                          margin:0pt 4pt 0pt 4pt">
                                @Model.Fabricante

                            </p>
                        </td>
                    </tr>
                    <tr style="background-color:#fff0e0;
                       background-size:auto;
                       background-origin:padding-box;
                       background-clip:border-box">
                        @*<td style="background-color:#ffffff;
                               background-size:auto;
                               background-origin:padding-box;
                               background-clip:border-box;
                               border-right:1pt solid #C0C0C0;
                               font-family:Arial, Helvetica, sans-serif;
                               font-size:10pt;
                               width:5px"
                            valign="bottom"></td>*@
                        <td style="width:70px;
                           border-right:1pt solid #C0C0C0;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;"
                            valign="bottom">
                            <p style="font-family:Arial, Helvetica, sans-serif;
                              color:#808080;
                              font-weight:bold;
                              font-size:8pt;
                              vertical-align:top;
                              margin:1pt 0pt 0pt 2pt">
                                Produto
                            </p>
                        </td>
                        <td style="border-right:1pt solid #C0C0C0;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;
                           width:280px;
                           " valign="bottom">
                            <p style="font-family:Arial, Helvetica, sans-serif;
                              color:#808080;
                              font-weight:bold;
                              font-size:8pt;
                              vertical-align:top;
                              margin:1pt 0pt 0pt 2pt">
                                Descrição
                            </p>
                        </td>
                        <td style="width:100px;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;"
                            valign="bottom" ;>
                            <p style="font-weight:bold;
                              font-family:Arial, Helvetica, sans-serif;
                              color:#808080;
                              font-size:8pt;
                              vertical-align:top;
                              margin:0pt 4pt 0pt 2pt;
                              text-align:right">
                                Preço
                            </p>
                        </td>
                    </tr>
                    @foreach (var i in Model.LstProdutos)
                    {
                        <tr>
                            @*<td style="background-color:#ffffff;
                                   background-size:auto;
                                   background-origin:padding-box;
                                   background-clip:border-box;
                                   border-right:1pt solid #C0C0C0;
                                   font-family:Arial, Helvetica, sans-serif;
                                   font-size:10pt;
                                   width:5px"
                                valign="bottom"></td>*@
                            <td style="width:70px;
                           border-right:1pt solid #C0C0C0;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;"
                                valign="bottom">
                                <p style="font-family:Arial, Helvetica, sans-serif;
                              color:black;
                              font-weight:bold;
                              font-size:8pt;
                              vertical-align:top;
                              margin:0pt 2pt 1pt 2pt">
                                    @i.Produto
                                </p>
                            </td>
                            <td style="border-right:1pt solid #C0C0C0;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;
                           width:280px;
                           " valign="bottom">
                                <p style="font-family:Arial, Helvetica, sans-serif;
                              color:black;
                              font-weight:bold;
                              font-size:8pt;
                              vertical-align:top;
                              margin:0pt 2pt 1pt 2pt">
                                    @i.Descricao
                                </p>
                            </td>
                            <td style="width:100px;
                           border-bottom:1pt solid #C0C0C0;
                           font-family:Arial, Helvetica, sans-serif;
                           font-size:10pt;"
                                valign="bottom" ;>
                                <p onload="moeda(this)" style="font-weight:bold;
                              font-family:Arial, Helvetica, sans-serif;
                              color:black;
                              font-size:8pt;
                              vertical-align:top;
                              margin:0pt 4pt 0pt 2pt;
                              text-align:right">
                                    @String.Format("{0:c}", i.Preco)
                                </p>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    }

</div>
<script>
    function mascara(o, f) {
        v_obj = o;
        v_fun = f;
        setTimeout("execmascara() ", 1);
    }

    function execmascara() {
        v_obj.value = v_fun(v_obj.value);
    }

    function leech(v) {
        v = v.replace(/o/gi, "0");
        v = v.replace(/i/gi, "1");
        v = v.replace(/z/gi, "2");
        v = v.replace(/e/gi, "3");
        v = v.replace(/a/gi, "4");
        v = v.replace(/s/gi, "5");
        v = v.replace(/t/gi, "7");
        return v;
    }

    function soNumeros(v) {
        return v.replace(/\D/g, "");
    }

    function telefone(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/^(\d\d)(\d)/g, "($1) $2"); //Coloca parênteses em volta dos dois primeiros dígitos
        v = v.replace(/(\d{4})(\d)/, "$1 - $2"); //Coloca hífen entre o quarto e o quinto dígitos
        return v;
    }

    function cpf(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/(\d{3})(\d)/, "$1.$2"); //Coloca um ponto entre o terceiro e o quarto dígitos
        v = v.replace(/(\d{3})(\d)/, "$1.$2"); //Coloca um ponto entre o terceiro e o quarto dígitos
        //de novo (para o segundo bloco de números)
        v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2"); //Coloca um hífen entre o terceiro e o quarto dígitos
        return v;
    }

    function cep(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/(\d{2})(\d)/, "$1.$2"); //Coloca um ponto entre o terceiro e o quarto dígitos
        v = v.replace(/(\d{3})(\d{1,3})$/, "$1-$2"); //Coloca um hífen entre o terceiro e o quarto dígitos
        return v;
    }

    function cnpj(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/^(\d{2})(\d)/, "$1.$2"); //Coloca ponto entre o segundo e o terceiro dígitos
        v = v.replace(/^(\d{2}).(\d{3})(\d)/, "$1.$2.$3"); //Coloca ponto entre o quinto e o sexto dígitos
        v = v.replace(/.(\d{3})(\d)/, ".$1/$2"); //Coloca uma barra entre o oitavo e o nono dígitos
        v = v.replace(/(\d{4})(\d)/, "$1-$2"); //Coloca um hífen depois do bloco de quatro dígitos
        return v;
    }

    function romanos(v) {
        v = v.toUpperCase(); //Maiúsculas
        v = v.replace(/[^IVXLCDM]/g, ""); //Remove tudo o que não for I, V, X, L, C, D ou M
        //Essa é complicada! Copiei daqui: http://www.diveintopython.org/refactoring/refactoring.html 41
        while (v.replace(/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/, "") != "");
        v = v.replace(/.$/, "");
        return v;
    }

    function data(v) {
        v = v.replace(/\D/g, ""); //Remove tudo o que não é dígito
        v = v.replace(/^(\d{2})(\d)/, "$1/$2"); //Coloca ponto entre o segundo e o terceiro dígitos
        v = v.replace(/.(\d{2})(\d)/, ".$1/$2"); //Coloca uma barra entre o oitavo e o nono dígitos
        v = v.replace(/(\d{2})(\d)/, "$1/$2"); //Coloca um hífen depois do bloco de quatro dígitos
        return v;
    }

    function moeda(v) {
        v = v.replace(/\D/g, ""); // permite digitar apenas numero
        v = v.replace(/(\d{1})(\d{17})$/, "$1.$2"); // coloca ponto antes dos ultimos digitos
        v = v.replace(/(\d{1})(\d{13})$/, "$1.$2"); // coloca ponto antes dos ultimos 13 digitos
        v = v.replace(/(\d{1})(\d{10})$/, "$1.$2"); // coloca ponto antes dos ultimos 10 digitos
        v = v.replace(/(\d{1})(\d{7})$/, "$1.$2"); // coloca ponto antes dos ultimos 7 digitos
        v = v.replace(/(\d{1})(\d{1,4})$/, "$1,$2"); // coloca virgula antes dos ultimos 4 digitos
        return v;
    }

    function Imprimir() {
        //afazer:montar uma div para impressão
        var divToPrint = document.getElementById('tabelateste');
        divToPrint.style.visibility = 'visible';
        var htmlToPrint = '' +
            '<style type="text/css">' +
            'tabela {' +
            'visibility:visible;' +
            '}' +
            '</style>';
        htmlToPrint += divToPrint.outerHTML;
        newWin = window.open("");
        newWin.document.write("<h3 align='center'>Print Page</h3>");
        newWin.document.write(htmlToPrint);
        newWin.print();
        newWin.close();
        divToPrint.style.visibility = 'collapse';
    }
</script>


